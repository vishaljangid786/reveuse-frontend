{"version":3,"file":"AllServices.CkOjfkIV.js","sources":["../../src/Pages/admin/AllServices.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { backendurl } from \"../../App\";\r\nimport Heading from \"../../components/Heading\";\r\nimport Loader from \"../../components/Loader\";\r\n\r\nconst AllServices = () => {\r\n  const [services, setServices] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n  const [editingService, setEditingService] = useState(null);\r\n  const [updating, setUpdating] = useState(false);\r\n\r\n  const [formData, setFormData] = useState({\r\n    title: \"\",\r\n    description: \"\",\r\n    image: null,\r\n  });\r\n\r\n  useEffect(() => {\r\n    fetchServices();\r\n  }, []);\r\n\r\n  const fetchServices = async () => {\r\n    try {\r\n      const res = await fetch(`${backendurl}/api/services`);\r\n      if (!res.ok) {\r\n        throw new Error(\"Failed to fetch services\");\r\n      }\r\n      const data = await res.json();\r\n      setServices(data);\r\n    } catch (err) {\r\n      setError(err.message || \"Failed to fetch services\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    if (!window.confirm(\"Are you sure you want to delete this service?\"))\r\n      return;\r\n    try {\r\n      const res = await fetch(`${backendurl}/api/services/${id}`, {\r\n        method: \"DELETE\",\r\n      });\r\n      if (!res.ok) {\r\n        throw new Error(\"Failed to delete service\");\r\n      }\r\n      setServices((prev) => prev.filter((s) => s._id !== id));\r\n    } catch (err) {\r\n      alert(err.message || \"Failed to delete service.\");\r\n    }\r\n  };\r\n\r\n  const startEditing = (service) => {\r\n    setEditingService(service);\r\n    setFormData({\r\n      title: service.title,\r\n      description: service.description,\r\n      image: null,\r\n    });\r\n  };\r\n\r\n  const handleEditChange = (e) => {\r\n    const { name, value, files } = e.target;\r\n    if (name === \"image\") {\r\n      setFormData((prev) => ({ ...prev, image: files[0] }));\r\n    } else {\r\n      setFormData((prev) => ({ ...prev, [name]: value }));\r\n    }\r\n  };\r\n\r\n  const handleUpdate = async (e) => {\r\n    e.preventDefault();\r\n    if (!editingService) return;\r\n\r\n    // Check if image is too large (max 10MB)\r\n    if (formData.image && formData.image.size > 5 * 1024 * 1024) {\r\n      alert(\"Image file is too large. Maximum size is 5MB.\");\r\n      return;\r\n    }\r\n\r\n    const data = new FormData();\r\n    data.append(\"title\", formData.title);\r\n    data.append(\"description\", formData.description);\r\n    if (formData.image) {\r\n      data.append(\"image\", formData.image);\r\n    }\r\n\r\n    try {\r\n      setUpdating(true);\r\n      const res = await fetch(\r\n        `${backendurl}/api/services/${editingService._id}`,\r\n        {\r\n          method: \"PUT\",\r\n          body: data,\r\n        }\r\n      );\r\n      if (!res.ok) {\r\n        throw new Error(\"Failed to update service\");\r\n      }\r\n      const updatedService = await res.json();\r\n      setServices((prev) =>\r\n        prev.map((s) => (s._id === updatedService._id ? updatedService : s))\r\n      );\r\n      setEditingService(null);\r\n    } catch (err) {\r\n      alert(err.message || \"Failed to update service.\");\r\n    } finally {\r\n      setUpdating(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-6xl mx-auto px-4 py-10\">\r\n      <Heading text1={\"All\"} text2=\"Services\" />\r\n      {error && <p className=\"text-center text-red-500\">{error}</p>}\r\n      {loading ? (\r\n        <Loader />\r\n      ) : error ? (\r\n        <p className=\"text-center text-red-500\">{error}</p>\r\n      ) : (\r\n        <div className=\"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3\">\r\n          {services.map((service) => (\r\n            <div\r\n              key={service._id}\r\n              className=\"bg-white shadow-lg rounded-xl overflow-hidden hover:shadow-2xl transition duration-300\">\r\n              {service.imageUrl && (\r\n                <img\r\n                  loading=\"lazy\"\r\n                  src={service.imageUrl}\r\n                  alt={service.title}\r\n                  className=\"w-full h-48 object-cover\"\r\n                />\r\n              )}\r\n              <div className=\"p-4\">\r\n                <h3 className=\"text-xl font-semibold mb-2\">{service.title}</h3>\r\n                <p className=\"text-gray-600 mb-4\">\r\n                  {service.description.split(\" \").slice(0, 20).join(\" \")}\r\n                  {service.description.split(\" \").length > 20 ? \"...\" : \"\"}\r\n                </p>\r\n\r\n                <div className=\"flex gap-2\">\r\n                  <button\r\n                    onClick={() => startEditing(service)}\r\n                    className=\"px-4 py-1 bg-yellow-400 rounded-md text-white border-2 border-yellow-400 hover:bg-transparent transition hover:text-yellow-400 text-sm\">\r\n                    Edit\r\n                  </button>\r\n                  <button\r\n                    onClick={() => handleDelete(service._id)}\r\n                    className=\"px-4 py-1 bg-red-500 text-white rounded-md hover:bg-transparent hover:text-red-500 border-2 border-red-500 transition text-sm\">\r\n                    Delete\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {editingService && (\r\n        <div className=\"fixed inset-0 bg-[#3535357d] flex items-center justify-center z-50\">\r\n          <form\r\n            onSubmit={handleUpdate}\r\n            className=\"bg-white p-6 rounded-xl shadow-xl w-full max-w-md space-y-4 relative\">\r\n            <h2 className=\"text-xl font-bold mb-2\">Edit Service</h2>\r\n            <input\r\n              type=\"text\"\r\n              name=\"title\"\r\n              value={formData.title}\r\n              onChange={handleEditChange}\r\n              required\r\n              placeholder=\"Title\"\r\n              className=\"w-full p-2 border border-gray-600 rounded-md\"\r\n            />\r\n            <textarea\r\n              name=\"description\"\r\n              value={formData.description}\r\n              onChange={handleEditChange}\r\n              rows={4}\r\n              required\r\n              placeholder=\"Description\"\r\n              className=\"w-full p-2 border border-gray-600 rounded-md\"\r\n            />\r\n            <input\r\n              type=\"file\"\r\n              name=\"image\"\r\n              onChange={handleEditChange}\r\n              accept=\"image/*\"\r\n              className=\"cursor-pointer\"\r\n            />\r\n            <div className=\"flex justify-end gap-2\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setEditingService(null)}\r\n                className=\"px-4 py-1 bg-gray-300 rounded-md\">\r\n                Cancel\r\n              </button>\r\n              <button\r\n                type=\"submit\"\r\n                className=\"px-4 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700\"\r\n                disabled={updating}>\r\n                {updating ? \"Updating...\" : \"Update\"}\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AllServices;\r\n"],"names":["AllServices","services","setServices","useState","loading","setLoading","error","setError","editingService","setEditingService","updating","setUpdating","formData","setFormData","title","description","image","useEffect","fetchServices","async","res","fetch","backendurl","ok","Error","data","json","err","message","handleEditChange","e","name","value","files","target","prev","jsxs","className","children","jsx","Heading","text1","text2","Loader","map","service","imageUrl","src","alt","split","slice","join","length","onClick","startEditing","id","window","confirm","method","filter","s","_id","alert","handleDelete","onSubmit","preventDefault","size","FormData","append","body","updatedService","type","onChange","required","placeholder","rows","accept","disabled"],"mappings":"uGAKA,MAAMA,EAAc,KAClB,MAAOC,EAAUC,GAAeC,EAAAA,SAAS,KAClCC,EAASC,GAAcF,EAAAA,UAAS,IAChCG,EAAOC,GAAYJ,EAAAA,SAAS,KAC5BK,EAAgBC,GAAqBN,EAAAA,SAAS,OAC9CO,EAAUC,GAAeR,EAAAA,UAAS,IAElCS,EAAUC,GAAeV,WAAS,CACvCW,MAAO,GACPC,YAAa,GACbC,MAAO,OAGTC,EAAAA,UAAU,KACRC,KACC,IAEH,MAAMA,EAAgBC,UACpB,IACE,MAAMC,QAAYC,MAAM,GAAGC,kBAC3B,IAAKF,EAAIG,GACP,MAAM,IAAIC,MAAM,4BAElB,MAAMC,QAAaL,EAAIM,OACvBxB,EAAYuB,EAAI,OACTE,GACPpB,EAASoB,EAAIC,SAAW,2BAA0B,CACpD,QACEvB,GAAW,EAAK,GA6BdwB,EAAoBC,IACxB,MAAMC,KAAEA,EAAAC,MAAMA,EAAAC,MAAOA,GAAUH,EAAEI,OAE/BrB,EADW,UAATkB,EACWI,QAAeA,EAAMnB,MAAOiB,EAAM,KAElCE,QAAeA,EAAMJ,CAACA,GAAOC,MA6C9C,OACEI,EAAAA,KAAC,MAAA,CAAIC,UAAU,+BACbC,SAAA,CAAAC,EAAAA,IAACC,EAAA,CAAQC,MAAO,MAAOC,MAAM,aAC5BpC,GAASiC,EAAAA,IAAC,IAAA,CAAEF,UAAU,2BAA4BC,SAAAhC,IAClDF,EACCmC,EAAAA,IAACI,EAAA,CAAA,GACCrC,EACFiC,EAAAA,IAAC,KAAEF,UAAU,2BAA4BC,SAAAhC,UAExC,MAAA,CAAI+B,UAAU,uDACZC,SAAArC,EAAS2C,IAAKC,GACbT,EAAAA,KAAC,MAAA,CAECC,UAAU,yFACTC,SAAA,CAAAO,EAAQC,UACPP,EAAAA,IAAC,MAAA,CACCnC,QAAQ,OACR2C,IAAKF,EAAQC,SACbE,IAAKH,EAAQ/B,MACbuB,UAAU,6BAGdD,EAAAA,KAAC,MAAA,CAAIC,UAAU,MACbC,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAGF,UAAU,6BAA8BC,SAAAO,EAAQ/B,QACpDsB,EAAAA,KAAC,IAAA,CAAEC,UAAU,qBACVC,SAAA,CAAAO,EAAQ9B,YAAYkC,MAAM,KAAKC,MAAM,EAAG,IAAIC,KAAK,KACjDN,EAAQ9B,YAAYkC,MAAM,KAAKG,OAAS,GAAK,MAAQ,MAGxDhB,EAAAA,KAAC,MAAA,CAAIC,UAAU,aACbC,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACCc,QAAS,IA1FN,CAACR,IACpBpC,EAAkBoC,GAClBhC,EAAY,CACVC,MAAO+B,EAAQ/B,MACfC,YAAa8B,EAAQ9B,YACrBC,MAAO,QAqFsBsC,CAAaT,GAC5BR,UAAU,yIAAyIC,SAAA,SAGrJC,EAAAA,IAAC,SAAA,CACCc,QAAS,IA/GNlC,OAAOoC,IAC1B,GAAKC,OAAOC,QAAQ,iDAEpB,IAIE,WAHkBpC,MAAM,GAAGC,kBAA2BiC,IAAM,CAC1DG,OAAQ,YAEDnC,GACP,MAAM,IAAIC,MAAM,4BAElBtB,EAAaiC,GAASA,EAAKwB,OAAQC,GAAMA,EAAEC,MAAQN,GAAG,OAC/C5B,GACPmC,MAAMnC,EAAIC,SAAW,4BAA2B,GAmGnBmC,CAAalB,EAAQgB,KACpCxB,UAAU,gIAAgIC,SAAA,mBAzB3IO,EAAQgB,QAmCpBrD,GACC+B,EAAAA,IAAC,MAAA,CAAIF,UAAU,qEACbC,SAAAF,EAAAA,KAAC,OAAA,CACC4B,SA3FW7C,MAAOW,IAE1B,GADAA,EAAEmC,kBACGzD,EAAgB,OAGrB,GAAII,EAASI,OAASJ,EAASI,MAAMkD,KAAO,QAE1C,YADAJ,MAAM,iDAIR,MAAMrC,EAAO,IAAI0C,SACjB1C,EAAK2C,OAAO,QAASxD,EAASE,OAC9BW,EAAK2C,OAAO,cAAexD,EAASG,aAChCH,EAASI,OACXS,EAAK2C,OAAO,QAASxD,EAASI,OAGhC,IACEL,GAAY,GACZ,MAAMS,QAAYC,MAChB,GAAGC,kBAA2Bd,EAAeqD,MAC7C,CACEH,OAAQ,MACRW,KAAM5C,IAGV,IAAKL,EAAIG,GACP,MAAM,IAAIC,MAAM,4BAElB,MAAM8C,QAAuBlD,EAAIM,OACjCxB,EAAaiC,GACXA,EAAKS,IAAKgB,GAAOA,EAAEC,MAAQS,EAAeT,IAAMS,EAAiBV,IAEnEnD,EAAkB,KAAI,OACfkB,GACPmC,MAAMnC,EAAIC,SAAW,4BAA2B,CAClD,QACEjB,GAAY,EAAK,GAuDX0B,UAAU,uEACVC,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAGF,UAAU,yBAAyBC,SAAA,iBACvCC,EAAAA,IAAC,QAAA,CACCgC,KAAK,OACLxC,KAAK,QACLC,MAAOpB,EAASE,MAChB0D,SAAU3C,EACV4C,UAAQ,EACRC,YAAY,QACZrC,UAAU,iDAEZE,EAAAA,IAAC,WAAA,CACCR,KAAK,cACLC,MAAOpB,EAASG,YAChByD,SAAU3C,EACV8C,KAAM,EACNF,UAAQ,EACRC,YAAY,cACZrC,UAAU,iDAEZE,EAAAA,IAAC,QAAA,CACCgC,KAAK,OACLxC,KAAK,QACLyC,SAAU3C,EACV+C,OAAO,UACPvC,UAAU,mBAEZD,EAAAA,KAAC,MAAA,CAAIC,UAAU,yBACbC,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACCgC,KAAK,SACLlB,QAAS,IAAM5C,EAAkB,MACjC4B,UAAU,mCAAmCC,SAAA,WAG/CC,EAAAA,IAAC,SAAA,CACCgC,KAAK,SACLlC,UAAU,gEACVwC,SAAUnE,EACT4B,WAAW,cAAgB"}