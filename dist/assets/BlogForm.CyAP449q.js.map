{"version":3,"file":"BlogForm.CyAP449q.js","sources":["../../src/Pages/admin/BlogForm.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport Heading from \"../../components/Heading\";\r\nimport { backendurl } from \"../../App\";\r\n\r\nconst BlogForm = () => {\r\n  const [formData, setFormData] = useState({\r\n    title: \"\",\r\n    content: \"\",\r\n    image: null,\r\n  });\r\n  const [preview, setPreview] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [dragActive, setDragActive] = useState(false);\r\n\r\n  const isLoggedIn = () => localStorage.getItem(\"token\");\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value, files } = e.target;\r\n    if (name === \"image\" && files.length > 0) {\r\n      handleImage(files[0]);\r\n    } else {\r\n      setFormData((prev) => ({ ...prev, [name]: value }));\r\n    }\r\n  };\r\n\r\n  const handleImage = (file) => {\r\n    setFormData((prev) => ({ ...prev, image: file }));\r\n    setPreview(URL.createObjectURL(file));\r\n  };\r\n\r\n  const handleDrag = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    if (e.type === \"dragenter\" || e.type === \"dragover\") {\r\n      setDragActive(true);\r\n    } else if (e.type === \"dragleave\") {\r\n      setDragActive(false);\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragActive(false);\r\n    if (e.dataTransfer.files && e.dataTransfer.files[0]) {\r\n      handleImage(e.dataTransfer.files[0]);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setMessage(\"\");\r\n\r\n    const token = isLoggedIn();\r\n    if (!token) {\r\n      setMessage(\"You must be logged in to create a blog.\");\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    const data = new FormData();\r\n    data.append(\"title\", formData.title);\r\n    data.append(\"content\", formData.content);\r\n    if (formData.image) {\r\n      data.append(\"image\", formData.image);\r\n    } else {\r\n      setMessage(\"Please upload an image.\");\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`${backendurl}/api/blogs`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n        body: data,\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({\r\n          error: \"Failed to create blog and could not parse error response.\",\r\n        }));\r\n        throw new Error(\r\n          errorData.error || \"Failed to create blog. Please try again.\"\r\n        );\r\n      }\r\n\r\n      const result = await response.json();\r\n      setMessage(\"Blog created successfully!\");\r\n      setFormData({ title: \"\", content: \"\", image: null });\r\n      setPreview(null);\r\n    } catch (err) {\r\n      setMessage(err.message || \"Failed to create blog. Please try again.\");\r\n      console.error(\"Error creating blog:\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-xl mx-auto p-6 bg-white shadow-2xl rounded-2xl mt-10\">\r\n      <h2 className=\"text-2xl font-bold mb-4 text-center\">\r\n        <Heading text1=\"Create\" text2=\"Blog\" />\r\n      </h2>\r\n\r\n      <form\r\n        onSubmit={handleSubmit}\r\n        onDragEnter={handleDrag}\r\n        onDragOver={handleDrag}\r\n        onDragLeave={handleDrag}\r\n        onDrop={handleDrop}\r\n        className=\"space-y-5\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">\r\n            Title\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            name=\"title\"\r\n            placeholder=\"Enter blog title\"\r\n            value={formData.title}\r\n            onChange={handleChange}\r\n            required\r\n            className=\"mt-1 w-full p-2 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700\">\r\n            Content\r\n          </label>\r\n          <textarea\r\n            name=\"content\"\r\n            placeholder=\"Write your blog content here\"\r\n            value={formData.content}\r\n            onChange={handleChange}\r\n            required\r\n            rows=\"6\"\r\n            className=\"mt-1 w-full p-2 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n            Image\r\n          </label>\r\n          <div\r\n            className={`w-full p-6 border-2 border-dashed rounded-lg text-center transition ${\r\n              dragActive ? \"border-blue-600 bg-blue-50\" : \"border-gray-400\"\r\n            }`}>\r\n            <p className=\"mb-2 text-gray-500\">\r\n              Drag & drop an image here, or{\" \"}\r\n              <span className=\"text-blue-600 underline\">browse</span>\r\n            </p>\r\n            <label className=\"inline-block bg-gray-200 text-gray-800 px-4 py-2 rounded-lg cursor-pointer hover:bg-gray-300 transition duration-200\">\r\n              Choose File\r\n              <input\r\n                type=\"file\"\r\n                name=\"image\"\r\n                accept=\"image/*\"\r\n                onChange={handleChange}\r\n                className=\"hidden\"\r\n              />\r\n            </label>\r\n          </div>\r\n\r\n          {preview && (\r\n            <img\r\n              loading=\"lazy\"\r\n              src={preview}\r\n              alt=\"Preview\"\r\n              className=\"mt-4 rounded-lg w-full h-48 object-cover\"\r\n            />\r\n          )}\r\n        </div>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          className=\"w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-300\">\r\n          {loading ? \"Creating...\" : \"Create Blog\"}\r\n        </button>\r\n      </form>\r\n\r\n      {message && (\r\n        <p className=\"mt-4 text-center text-sm text-gray-600\">{message}</p>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BlogForm;\r\n"],"names":["BlogForm","formData","setFormData","useState","title","content","image","preview","setPreview","loading","setLoading","message","setMessage","dragActive","setDragActive","handleChange","e","name","value","files","target","length","handleImage","prev","file","URL","createObjectURL","handleDrag","preventDefault","stopPropagation","type","jsxs","className","children","jsx","Heading","text1","text2","onSubmit","async","token","localStorage","getItem","data","FormData","append","response","fetch","backendurl","method","headers","Authorization","body","ok","errorData","json","catch","error","Error","err","console","onDragEnter","onDragOver","onDragLeave","onDrop","dataTransfer","placeholder","onChange","required","rows","accept","src","alt","disabled"],"mappings":"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"}