{"version":3,"file":"AllBlog.UeOpHN2U.js","sources":["../../src/Pages/admin/AllBlog.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { backendurl } from \"../../App\";\r\nimport Heading from \"../../components/Heading\";\r\nimport Loader from \"../../components/Loader\";\r\n\r\nconst AllBlog = () => {\r\n  const [blogs, setBlogs] = useState([]);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [selectedBlog, setSelectedBlog] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [formData, setFormData] = useState({\r\n    title: \"\",\r\n    content: \"\",\r\n    imageUrl: \"\",\r\n  });\r\n\r\n  useEffect(() => {\r\n    fetchBlogs();\r\n  }, []);\r\n\r\n  const fetchBlogs = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch(`${backendurl}/api/blogs`);\r\n      if (!res.ok) {\r\n        throw new Error(`HTTP error! status: ${res.status}`);\r\n      }\r\n      const data = await res.json();\r\n      setBlogs(data);\r\n    } catch (err) {\r\n      console.error(err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleEditClick = (blog) => {\r\n    setSelectedBlog(blog);\r\n    setFormData({\r\n      title: blog.title,\r\n      content: blog.content,\r\n      imageUrl: blog.imageUrl,\r\n    });\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleDeleteClick = (blog) => {\r\n    const confirmed = window.confirm(\r\n      \"Are you sure you want to delete this blog?\"\r\n    );\r\n    if (confirmed) {\r\n      fetch(`${backendurl}/api/blogs/${blog._id}`, {\r\n        method: \"DELETE\",\r\n      })\r\n        .then((res) => {\r\n          if (!res.ok) throw new Error(\"Delete failed\");\r\n          fetchBlogs();\r\n        })\r\n        .catch((err) => {\r\n          console.error(\"Delete error:\", err);\r\n        });\r\n    }\r\n  };\r\n\r\n  const handleUpdate = () => {\r\n    if (!selectedBlog) return;\r\n\r\n    const updatedFormData = new FormData();\r\n    updatedFormData.append(\"title\", formData.title);\r\n    updatedFormData.append(\"content\", formData.content);\r\n    updatedFormData.append(\"imageUrl\", formData.imageUrl);\r\n    if (formData.newImageFile) {\r\n      updatedFormData.append(\"image\", formData.newImageFile);\r\n    }\r\n\r\n    fetch(`${backendurl}/api/blogs/${selectedBlog._id}`, {\r\n      method: \"PUT\",\r\n      body: updatedFormData,\r\n    })\r\n      .then((res) => {\r\n        if (!res.ok) throw new Error(\"Update failed\");\r\n        return res.json();\r\n      })\r\n      .then(() => {\r\n        fetchBlogs();\r\n        setIsModalOpen(false);\r\n        setFormData({ title: \"\", content: \"\", imageUrl: \"\" });\r\n        setSelectedBlog(null);\r\n      })\r\n      .catch((err) => {\r\n        console.error(\"Update error:\", err);\r\n      });\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData((prev) => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-5xl min-h-screen mx-auto px-4 py-10\">\r\n      <Heading text1={\"All\"} text2={\"Blog\"} />\r\n\r\n      {loading ? (\r\n        <Loader />\r\n      ) : blogs.length > 0 ? (\r\n        <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\r\n          {blogs.map((blog) => (\r\n            <div\r\n              key={blog._id}\r\n              className=\"bg-white shadow-md rounded-xl p-5 space-y-3\">\r\n              {blog.imageUrl && (\r\n                <img\r\n                  loading=\"lazy\"\r\n                  src={\r\n                    blog.imageUrl.startsWith(\"http\")\r\n                      ? blog.imageUrl\r\n                      : `${backendurl}${blog.imageUrl}`\r\n                  }\r\n                  alt={blog.title}\r\n                  className=\"w-full h-48 object-cover rounded-md\"\r\n                />\r\n              )}\r\n\r\n              <h2 className=\"text-xl font-semibold text-gray-800\">\r\n                {blog.title}\r\n              </h2>\r\n              <p className=\"text-gray-600\">{blog.content.slice(0, 100)}...</p>\r\n\r\n              <div className=\"flex items-center justify-between text-sm text-gray-500 mt-2\">\r\n                <span>üëç {blog.likes}</span>\r\n                <span>üí¨ {blog?.comments?.length || 0}</span>\r\n                <span>üìÖ {new Date(blog.createdAt).toLocaleDateString()}</span>\r\n              </div>\r\n\r\n              <div className=\"flex gap-2\">\r\n                <button\r\n                  className=\"text-white-600 hover:bg-transparent bg-yellow-400 border-2 border-yellow-400  text-white px-4 rounded hover:text-yellow-400 transition cursor-pointer\"\r\n                  onClick={() => handleEditClick(blog)}>\r\n                  Edit\r\n                </button>\r\n                <button\r\n                  className=\"bg-red-500 text-white border-2 border-red-500 hover:bg-transparent hover:text-red-500 px-4 rounded cursor-pointer\"\r\n                  onClick={() => handleDeleteClick(blog)}>\r\n                  Delete\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      ) : (\r\n        <p className=\"text-center\">No Blogs yet.</p>\r\n      )}\r\n\r\n      {isModalOpen && (\r\n        <div className=\"fixed inset-0 bg-black/60 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white p-6 rounded-xl w-[90%] max-w-2xl shadow-xl relative\">\r\n            <h2 className=\"text-2xl font-bold text-gray-800 mb-6 border-b pb-2\">\r\n              ‚úèÔ∏è Edit Blog\r\n            </h2>\r\n\r\n            <div className=\"space-y-4\">\r\n              <label className=\"block text-sm font-semibold text-gray-700\">\r\n                Title\r\n                <input\r\n                  type=\"text\"\r\n                  name=\"title\"\r\n                  value={formData.title}\r\n                  onChange={handleChange}\r\n                  placeholder=\"Blog title...\"\r\n                  className=\"mt-1 w-full border border-gray-300 px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400\"\r\n                />\r\n              </label>\r\n\r\n              <label className=\"block text-sm font-semibold text-gray-700\">\r\n                Content\r\n                <textarea\r\n                  name=\"content\"\r\n                  value={formData.content}\r\n                  onChange={handleChange}\r\n                  placeholder=\"Blog content...\"\r\n                  rows={5}\r\n                  className=\"mt-1 w-full border border-gray-300 px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400\"></textarea>\r\n              </label>\r\n\r\n              <label className=\"block text-sm font-semibold text-gray-700 mt-2\">\r\n                Change Image\r\n                <input\r\n                  type=\"file\"\r\n                  accept=\"image/*\"\r\n                  onChange={(e) =>\r\n                    setFormData({\r\n                      ...formData,\r\n                      newImageFile: e.target.files[0],\r\n                    })\r\n                  }\r\n                  className=\"mt-1 block w-full text-sm text-gray-700 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"\r\n                />\r\n              </label>\r\n            </div>\r\n\r\n            <div className=\"flex justify-end gap-4 mt-6\">\r\n              <button\r\n                className=\"bg-gray-300 border-2 border-gray-300 hover:bg-transparent cursor-pointer hover:text-red-500  text-gray-800 px-5 py-2 rounded-lg transition-all\"\r\n                onClick={() => setIsModalOpen(false)}>\r\n                Cancel\r\n              </button>\r\n              <button\r\n                className=\"bg-blue-600 border-2 border-blue-600 cursor-pointer hover:bg-transparent hover:text-blue-600 text-white px-5 py-2 rounded-lg transition-all\"\r\n                onClick={handleUpdate}>\r\n                Save Changes\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AllBlog;\r\n"],"names":["AllBlog","blogs","setBlogs","useState","isModalOpen","setIsModalOpen","selectedBlog","setSelectedBlog","loading","setLoading","formData","setFormData","title","content","imageUrl","useEffect","fetchBlogs","async","res","fetch","backendurl","ok","Error","status","data","json","err","console","error","handleChange","e","name","value","target","prev","jsxs","className","children","jsx","Heading","text1","text2","Loader","length","map","blog","src","startsWith","alt","slice","likes","comments","Date","createdAt","toLocaleDateString","onClick","handleEditClick","window","confirm","_id","method","then","catch","handleDeleteClick","type","onChange","placeholder","rows","accept","newImageFile","files","updatedFormData","FormData","append","body"],"mappings":"uGAKA,MAAMA,EAAU,KACd,MAAOC,EAAOC,GAAYC,EAAAA,SAAS,KAC5BC,EAAaC,GAAkBF,EAAAA,UAAS,IACxCG,EAAcC,GAAmBJ,EAAAA,SAAS,OAC1CK,EAASC,GAAcN,EAAAA,UAAS,IAEhCO,EAAUC,GAAeR,WAAS,CACvCS,MAAO,GACPC,QAAS,GACTC,SAAU,KAGZC,EAAAA,UAAU,KACRC,KACC,IAEH,MAAMA,EAAaC,UACjBR,GAAW,GACX,IACE,MAAMS,QAAYC,MAAM,GAAGC,eAC3B,IAAKF,EAAIG,GACP,MAAM,IAAIC,MAAM,uBAAuBJ,EAAIK,UAE7C,MAAMC,QAAaN,EAAIO,OACvBvB,EAASsB,EAAI,OACNE,GACPC,QAAQC,MAAMF,EAAG,CACnB,QACEjB,GAAW,EAAK,GA8DdoB,EAAgBC,IACpB,MAAMC,KAAEA,EAAAC,MAAMA,GAAUF,EAAEG,OAC1BtB,EAAauB,QAAeA,EAAMH,CAACA,GAAOC,MAG5C,OACEG,EAAAA,KAAC,MAAA,CAAIC,UAAU,4CACbC,SAAA,CAAAC,EAAAA,IAACC,EAAA,CAAQC,MAAO,MAAOC,MAAO,SAE7BjC,EACC8B,EAAAA,IAACI,EAAA,CAAA,GACCzC,EAAM0C,OAAS,EACjBL,EAAAA,IAAC,MAAA,CAAIF,UAAU,2CACZC,SAAApC,EAAM2C,IAAKC,GACVV,EAAAA,KAAC,MAAA,CAECC,UAAU,8CACTC,SAAA,CAAAQ,EAAK/B,UACJwB,EAAAA,IAAC,MAAA,CACC9B,QAAQ,OACRsC,IACED,EAAK/B,SAASiC,WAAW,QACrBF,EAAK/B,SACL,GAAGM,IAAayB,EAAK/B,WAE3BkC,IAAKH,EAAKjC,MACVwB,UAAU,wCAIdE,EAAAA,IAAC,KAAA,CAAGF,UAAU,sCACXC,WAAKzB,QAERuB,EAAAA,KAAC,IAAA,CAAEC,UAAU,gBAAiBC,SAAA,CAAAQ,EAAKhC,QAAQoC,MAAM,EAAG,KAAK,SAEzDd,EAAAA,KAAC,MAAA,CAAIC,UAAU,+DACbC,SAAA,CAAAF,OAAC,OAAA,CAAKE,SAAA,CAAA,MAAIQ,EAAKK,gBACd,OAAA,CAAKb,SAAA,CAAA,MAAIQ,GAAMM,UAAUR,QAAU,YACnC,OAAA,CAAKN,SAAA,CAAA,MAAI,IAAIe,KAAKP,EAAKQ,WAAWC,2BAGrCnB,EAAAA,KAAC,MAAA,CAAIC,UAAU,aACbC,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACCF,UAAU,wJACVmB,QAAS,IAtGD,CAACV,IACvBtC,EAAgBsC,GAChBlC,EAAY,CACVC,MAAOiC,EAAKjC,MACZC,QAASgC,EAAKhC,QACdC,SAAU+B,EAAK/B,WAEjBT,GAAe,IA+FcmD,CAAgBX,GAAOR,SAAA,SAGxCC,EAAAA,IAAC,SAAA,CACCF,UAAU,oHACVmB,QAAS,IAjGC,CAACV,IACPY,OAAOC,QACvB,+CAGAvC,MAAM,GAAGC,eAAwByB,EAAKc,MAAO,CAC3CC,OAAQ,WAEPC,KAAM3C,IACL,IAAKA,EAAIG,GAAI,MAAM,IAAIC,MAAM,iBAC7BN,MAED8C,MAAOpC,IACNC,QAAQC,MAAM,gBAAiBF,MAoFRqC,CAAkBlB,GAAOR,SAAA,gBAlCvCQ,EAAKc,cA0Cf,IAAA,CAAEvB,UAAU,cAAcC,SAAA,kBAG5BjC,SACE,MAAA,CAAIgC,UAAU,kEACbC,SAAAF,EAAAA,KAAC,MAAA,CAAIC,UAAU,+DACbC,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAGF,UAAU,sDAAsDC,SAAA,iBAIpEF,EAAAA,KAAC,MAAA,CAAIC,UAAU,YACbC,SAAA,CAAAF,EAAAA,KAAC,QAAA,CAAMC,UAAU,4CAA4CC,SAAA,CAAA,QAE3DC,EAAAA,IAAC,QAAA,CACC0B,KAAK,OACLjC,KAAK,QACLC,MAAOtB,EAASE,MAChBqD,SAAUpC,EACVqC,YAAY,gBACZ9B,UAAU,mHAIdD,EAAAA,KAAC,QAAA,CAAMC,UAAU,4CAA4CC,SAAA,CAAA,UAE3DC,EAAAA,IAAC,WAAA,CACCP,KAAK,UACLC,MAAOtB,EAASG,QAChBoD,SAAUpC,EACVqC,YAAY,kBACZC,KAAM,EACN/B,UAAU,mHAGdD,EAAAA,KAAC,QAAA,CAAMC,UAAU,iDAAiDC,SAAA,CAAA,eAEhEC,EAAAA,IAAC,QAAA,CACC0B,KAAK,OACLI,OAAO,UACPH,SAAWnC,GACTnB,EAAY,IACPD,EACH2D,aAAcvC,EAAEG,OAAOqC,MAAM,KAGjClC,UAAU,wMAKhBD,EAAAA,KAAC,MAAA,CAAIC,UAAU,8BACbC,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACCF,UAAU,iJACVmB,QAAS,IAAMlD,GAAe,GAAQgC,SAAA,WAGxCC,EAAAA,IAAC,SAAA,CACCF,UAAU,8IACVmB,QAjJO,KACnB,IAAKjD,EAAc,OAEnB,MAAMiE,EAAkB,IAAIC,SAC5BD,EAAgBE,OAAO,QAAS/D,EAASE,OACzC2D,EAAgBE,OAAO,UAAW/D,EAASG,SAC3C0D,EAAgBE,OAAO,WAAY/D,EAASI,UACxCJ,EAAS2D,cACXE,EAAgBE,OAAO,QAAS/D,EAAS2D,cAG3ClD,MAAM,GAAGC,eAAwBd,EAAaqD,MAAO,CACnDC,OAAQ,MACRc,KAAMH,IAELV,KAAM3C,IACL,IAAKA,EAAIG,GAAI,MAAM,IAAIC,MAAM,iBAC7B,OAAOJ,EAAIO,SAEZoC,KAAK,KACJ7C,IACAX,GAAe,GACfM,EAAY,CAAEC,MAAO,GAAIC,QAAS,GAAIC,SAAU,KAChDP,EAAgB,QAEjBuD,MAAOpC,IACNC,QAAQC,MAAM,gBAAiBF,MAuHAW,SAAA"}